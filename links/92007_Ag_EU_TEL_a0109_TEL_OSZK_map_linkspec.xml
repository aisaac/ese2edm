<?xml version="1.0" encoding="utf-8" ?>
<Silk>
  <Prefixes>
    <Prefix id="rdf" namespace="http://www.w3.org/1999/02/22-rdf-syntax-ns#" />
    <Prefix id="rdfs" namespace="http://www.w3.org/2000/01/rdf-schema#" />
    <Prefix id="ore" namespace="http://www.openarchives.org/ore/terms/" />
    <Prefix id="owl" namespace="http://www.w3.org/2002/07/owl#" />
    <Prefix id="dcterms" namespace="http://purl.org/dc/terms/" />
    <Prefix id="bibo" namespace="http://purl.org/ontology/bibo/" />
    <Prefix id="dc" namespace="http://purl.org/dc/elements/1.1/" />
  </Prefixes>

  <DataSources>
    <DataSource id="europeana" type="file">
      <Param name="file" value="./rdf/92007_Ag_EU_TEL_a0109_TEL_OSZK_map.rdf"/>
      <Param name="format" value="RDF/XML"/>
    </DataSource>
    <DataSource id="nszl" type="sparqlEndpoint">
      <Param name="endpointURI" value="http://setaria.oszk.hu/sparql" />
      <Param name="pageSize" value="10000" />
    </DataSource>
  </DataSources>

  <Interlinks>
    <Interlink id="items">

      <LinkType>owl:sameAs</LinkType>

      <SourceDataset dataSource="europeana" var="a">
        <RestrictTo>
          ?a rdf:type ore:Proxy
        </RestrictTo>
      </SourceDataset>

      <TargetDataset dataSource="nszl" var="b" >
        <RestrictTo>
          ?b rdf:type bibo:Document .
          ?b dcterms:identifier ?o .
          FILTER ( regex(?o, "topomap.hu") || regex(?o, "corvina.oszk.hu") )
        </RestrictTo>
      </TargetDataset>

      <LinkCondition>
        <Compare metric="equality">
          <Input path="?a/dc:identifier" />
          <Input path="?b/dcterms:identifier" />
        </Compare>
      </LinkCondition>

      <Filter threshold="1" limit="1" />

      <Outputs>
        <Output minConfidence="0.99" type="file">
          <Param name="file" value="./rdf/92007_Ag_EU_TEL_a0109_TEL_OSZK_map_links.nt"/>
          <Param name="format" value="ntriples"/>
        </Output>
      </Outputs>

    </Interlink>
  </Interlinks>
</Silk>
